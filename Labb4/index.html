<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Chat App</title>

  <link rel="stylesheet" href="css/styles.css?v=1.0">

</head>

<body>
  <h1>Chat app</h1>
  <h2>Messages:</h2>
  <div id="messages">
    messages here
  </div>

  <p id=”heading”></p>

  <textarea name="messagebox" rows="10" cols="30">The cat was playing in the garden.</textarea>
  <br>
  <button id="postMsg" onclick="publish">Send</button>
</body>

<script src="https://cdn.pubnub.com/sdk/javascript/pubnub.4.21.7.js"></script>


<!-- Instantiate PubNub -->
<script type="text/javascript">

var pubnubDemo = new PubNub({

publishKey: 'pub-c-701807e9-652b-4981-9bef-a6024c7daefd',

subscribeKey: 'sub-c-543d2354-6bff-11e9-81d5-56c3556875f9'

});

var currentHeading;

// Publish a simple message to the “demo_tutorial” channel pubnub:
function publish() {
  var messagetxt = document.getElementById("messagebox").innerHTML;

  pubnubDemo.publish({ message: { "color" : messagetxt }, channel: currentHeading });

}
// Get event data
function deviceOrientationListener(event) {
  var alpha   = event.alpha; //z axis rotation [0,360)
  var beta     = event.beta; //x axis rotation [-180, 180]
  var gamma   = event.gamma; //y axis rotation [-90, 90]

  //Check if absolute values have been sent
  if (typeof event.webkitCompassHeading !== "undefined") {
    alpha = event.webkitCompassHeading; //for iOS devices
    var heading = alpha
    document.getElementById("heading").innerHTML = heading.toFixed([0]);
    currentHeading = heading.toFixed([0]);
  }
  else {
    alert("Your device is reporting relative alpha values, so this compass won't point north :(");
    var heading = 360 - alpha; //heading [0, 360)
    document.getElementById("heading").innerHTML = heading.toFixed([0]);
    currentHeading = heading.toFixed([0]);

  }
}

</script>

</html>
